<html>

<head>
<meta charset="UTF-8">
</head>
	
<body style="background:#35a414;">
<section style="
    display: flow-root;
"><section id="scoreboardSct" style="
    display: -webkit-inline-box;
    background: black;
    user-select: none;
    margin-bottom: 0.3ch;
    margin-top: -0.46ch;
"><section id="htm" style="
    display: inline-flex;
    margin-right: 0.3ch;
"><div id="hn" style="
    background: purple;
" contenteditable="true">Home</div><div id="hs" style="
    margin-left: 0.5ch;
">0</div></section><span id="scb_sep" style="margin:0;padding:0;border:0">-</span><section id="atm" style="
    display: inline-flex;
    margin-left: 0.3ch;
"><div id="as" style="
    margin-right: 0.5ch;
">0</div><div contenteditable="true" id="an" style="
    background: mediumblue;
">Away</div></section></section><div id="distInfo" style="user-select: none;color: white;margin-left: 0.2em;"></div></section>
<svg xmlns="http://www.w3.org/2000/svg" style="background:#35a414; height: -webkit-fill-available;" version="1.1" class="turf">
 <circle cx="344.96021" cy="215.88849" r="56.399384" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.0187595" class="marking"/>
 <circle cx="89.159378" cy="216.59732" r="55.659718" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.0185135" class="turf"/>
 <rect x="6.3170214" y="192.58911" width="15.779498" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect x="6.3170214" y="238.44827" width="15.779498" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect id="left_crossbar" x="6.3170214" y="193.32877" width=".73966396" height="45.119503" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle cx="21.356895" cy="6.3170624" r="6.163867" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle cx="21.356895" cy="6.3170624" r="5.4242029" style="fill:#35a414;stroke-width:0" class="turf"/>
 <circle cx="89.159378" cy="216.59732" r="5.4242029" style="fill:#35a414;stroke-width:0" class="turf"/>
 <rect x="14.454946" y="4.196167e-5" width="13.517153" height="6.3170214" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00166455" class="turf"/>
 <rect x="14.454946" y="5.6251373" width="6.9020095" height="7.5848303" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00163086" class="turf"/>
 <rect x="21.356895" y="339.41238" width="101.7038" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000632876" class="marking"/>
 <rect x="21.356895" y="91.624962" width="101.7038" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000632876" class="marking"/>
 <circle cx="89.159378" cy="215.8577" r="56.399384" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.0187595" class="marking"/>
 <circle cx="89.159378" cy="215.8577" r="55.659718" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00403942" class="turf"/>
 <rect x="122.32099" y="91.624962" width=".73966396" height="248.5271" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect x="22.096611" y="92.364632" width="100.22684" height="247.04778" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00303514" class="turf"/>
 <rect x="54.518452" y="159.42749" width=".73966396" height="112.92204" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect x="21.356895" y="159.42749" width="33.901268" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle cx="89.159378" cy="215.88849" r=".70884466" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000295061" class="marking"/>
 <rect x="21.356895" y="271.60986" width="33.901268" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(1,-1)" cx="21.356895" cy="-425.45996" r="6.163867" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(1,-1)" cx="21.356895" cy="-425.45996" r="5.4242029" style="fill:#35a414;stroke-width:0" class="turf"/>
 <rect id="top_sideline" x="21.356895" y="6.3170624" width=".73966396" height="419.14291" style="fill:#fff;stroke-width:.00163086" class="marking"/>
 <rect x="14.608352" y="418.92725" width="6.7485437" height="12.849731" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.0022696" class="turf"/>
 <rect x="17.658569" y="362.89673" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <rect transform="rotate(90)" x="425.45996" y="-83.920105" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <rect transform="rotate(90)" x="2.6187477" y="-83.920105" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <rect x="17.658569" y="68.140648" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <circle cx="344.96021" cy="215.88846" r="55.659718" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00403942" class="turf"/>
 <rect x="344.59039" y="6.3170624" width=".73966396" height="419.14291" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.0230416" class="marking"/>
 <circle cx="344.96021" cy="215.88846" r=".70884466" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000295061" class="marking"/>
 <circle transform="scale(-1,1)" cx="-344.96021" cy="215.88846" r="56.399384" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.0187595" class="marking"/>
 <circle transform="scale(-1,1)" cx="-600.75977" cy="216.59732" r="55.659718" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.0185135" class="turf"/>
 <rect transform="scale(-1,1)" x="-683.60211" y="192.58905" width="15.779498" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect transform="scale(-1,1)" x="-683.60211" y="238.44821" width="15.779498" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect id="right_crossbar" transform="scale(-1,1)" x="-683.60211" y="193.32874" width=".73966396" height="45.119503" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(-1,1)" cx="-668.56232" cy="6.3170204" r="6.163867" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(-1,1)" cx="-668.56232" cy="6.3170204" r="5.4242029" style="fill:#35a414;stroke-width:0" class="turf"/>
 <circle transform="scale(-1,1)" cx="-600.75977" cy="216.59732" r="5.4242029" style="fill:#35a414;stroke-width:0" class="turf"/>
 <rect transform="scale(-1,1)" x="-675.46423" width="13.517122" height="6.3170214" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00166455" class="turf"/>
 <rect transform="scale(-1,1)" x="-675.46423" y="5.6251183" width="6.9020095" height="7.5848303" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00163086" class="turf"/>
 <rect transform="scale(-1,1)" x="-668.56232" y="339.41238" width="101.7038" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000632876" class="marking"/>
 <rect transform="scale(-1,1)" x="-668.56232" y="91.624947" width="101.7038" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000632876" class="marking"/>
 <circle transform="scale(-1,1)" cx="-600.75977" cy="215.85767" r="56.399384" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.0187595" class="marking"/>
 <circle transform="scale(-1,1)" cx="-600.75977" cy="215.85767" r="55.659718" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00403942" class="turf"/>
 <rect transform="scale(-1,1)" x="-567.59814" y="91.624947" width=".73966396" height="248.5271" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect transform="scale(-1,1)" x="-667.82257" y="92.364601" width="100.22684" height="247.04778" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00303514" class="turf"/>
 <rect transform="scale(-1,1)" x="-635.4007" y="159.42746" width=".73966396" height="112.92204" style="fill:#fff;stroke-width:0" class="marking"/>
 <rect transform="scale(-1,1)" x="-668.56232" y="159.42746" width="33.901268" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(-1,1)" cx="-600.75977" cy="215.88846" r=".70884466" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000295061" class="marking"/>
 <rect transform="scale(-1,1)" x="-668.56232" y="271.60983" width="33.901268" height=".73966396" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(-1)" cx="-668.56232" cy="-425.4599" r="6.163867" style="fill:#fff;stroke-width:0" class="marking"/>
 <circle transform="scale(-1)" cx="-668.56232" cy="-425.4599" r="5.4242029" style="fill:#35a414;stroke-width:0" class="turf"/>
 <rect transform="scale(-1,1)" x="-668.56232" y="6.3170204" width=".73966396" height="419.14291" style="fill:#fff;stroke-width:.00163086" class="marking"/>
 <rect transform="scale(-1,1)" x="-675.31079" y="418.93832" width="6.7485437" height="12.849731" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.0022696" class="turf"/>
 <rect transform="scale(-1,1)" x="-672.26056" y="362.8967" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <rect transform="matrix(0,1,1,0,0,0)" x="425.45996" y="605.99902" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <rect transform="matrix(0,1,1,0,0,0)" x="2.6187096" y="605.99902" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <rect transform="scale(-1,1)" x="-672.26056" y="68.140602" width="3.6983199" height=".73966396" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.00516308" class="marking"/>
 <circle transform="scale(-1,1)" cx="-344.96021" cy="215.88846" r="55.659718" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00403942" class="turf"/>
 <rect transform="scale(-1,1)" x="-345.33002" y="6.3170204" width=".73966396" height="419.14291" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.0230416" class="marking"/>
 <circle transform="scale(-1,1)" cx="-344.96021" cy="215.88846" r=".70884466" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.000295061" class="marking"/>
 <rect  id="bottom_sideline" x="21.356895" y="424.72031" width="647.20599" height=".73966396" style="fill:#fff;stroke-width:.00163086" class="marking"/>
 <rect x="21.356895" y="6.3170624" width="647.20599" height=".73966396" style="fill:#fff;stroke-width:.00163086" class="marking"/>
 <rect transform="scale(-1)" x="-34.33239" y="-431.77698" width="12.975496" height="6.3170214" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00163086" class="turf"/>
 <rect transform="scale(-1)" x="-669.59576" y="-431.78806" width="14.009025" height="6.3170214" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00169457" class="turf"/>
 <rect transform="scale(-1)" x="-33.99202" y="-431.77698" width="13.85469" height="6.3170214" style="fill:#35a414;paint-order:stroke fill markers;stroke-width:.00168521" class="turf"/>
 <rect class="goalLine goalLine1 marking" x="21.356895" y="193.32878" width=".73962474" height="45.119488" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.935167"/>
 <rect class="goalLine goalLine2 marking" x="667.82263" y="193.32872" width=".73962474" height="45.119488" style="fill:#fff;paint-order:stroke fill markers;stroke-width:.935167"/>
</svg>

<script>

function absBoundingClientRect(el){
	let st = [window?.scrollY,
					window?.pageYOffset,
					el?.ownerDocument?.documentElement?.scrollTop,
					document?.documentElement?.scrollTop,
					document?.body?.parentNode?.scrollTop,
					document?.body?.scrollTop,
					document?.head?.scrollTop];
					
		let sl = [window?.scrollX,
						window?.pageXOffset,
						el?.ownerDocument?.documentElement?.scrollLeft,
						document?.documentElement?.scrollLeft,
						document?.body?.parentNode?.scrollLeft,
						document?.body?.scrollLeft,
						document?.head?.scrollLeft];
						
				let scrollTop=0;
				for(let k=0; k<st.length; k++){
					if(!!st[k] && typeof  st[k] !=='undefined' && st[k]>0){
						scrollTop=(st[k]>scrollTop)?st[k]:scrollTop;
					}
				}			

				let scrollLeft=0;
				for(let k=0; k<sl.length; k++){
					if(!!sl[k] && typeof  sl[k] !=='undefined' && sl[k]>0){
						scrollLeft=(sl[k]>scrollLeft)?sl[k]:scrollLeft;
					}
				}
	
	const rct=el.getBoundingClientRect();
	let r={};

	r.left=rct.left+scrollLeft;
	r.right=rct.right+scrollLeft;
	r.top=rct.top+scrollTop;
	r.bottom=rct.bottom+scrollTop;
	r.height=rct.height;
	r.width=rct.width;
	
	return r;
}

let firstDist=false;
let pitch=document.querySelector('SVG');
let dv=document.querySelector('div#distInfo');
let gl1=document.querySelector('rect.goalLine1');
let gl2=document.querySelector('rect.goalLine2');
let sb_sep=document.getElementById('scb_sep');
let left_crb=document.getElementById('left_crossbar');
let right_crb=document.getElementById('right_crossbar');
let top_sdl=document.getElementById('top_sideline');
let btm_sdl=document.getElementById('bottom_sideline');



let drg=null;
let chd=[...pitch.children];
let bpt=chd[54];
let hwl=chd[60];
pitch.style.width=(Math.abs(right_crb.x.baseVal.value)+Math.abs(left_crb.x.baseVal.value))+'px';
pitch.style.height=(Math.abs(top_sdl.y.baseVal.value)+Math.abs(top_sdl.y.baseVal.value)+Math.abs(top_sdl.height.baseVal.value))+'px';
function rsz(){
let ptw=window.getComputedStyle(pitch);
let ptr=absBoundingClientRect(pitch);
let ptww=parseFloat(ptw.width)-ptr.left;
let ptwh=parseFloat(ptw.height)+ptr.top;

let bdw=window.getComputedStyle(document.body);
let bdyCh=parseFloat(bdw.height);
let bdyCw=parseFloat(bdw.width);


pitch.style.transformOrigin='top left';
let s=(bdyCw<bdyCh)?bdyCw/ptww:bdyCh/ptwh;
pitch.style.transform='scale('+s+')';
}

rsz();

let scoreboard={
	board: document.getElementById('scoreboardSct'),
	htn: document.getElementById('htm'),
	atn: document.getElementById('atm'),
	hts: document.getElementById('hs'),
	ats: document.getElementById('as')
}

let hwlR=absBoundingClientRect(hwl);
let sb_sep_R=absBoundingClientRect(sb_sep);
scoreboard.board.style.marginLeft=((hwlR.left+0.5*hwlR.width)-(sb_sep_R.left+0.5*sb_sep_R.width))+'px';

window.onresize=function(event){
	rsz();
}

window.visualViewport.addEventListener("resize", rsz);

window.oncontextmenu=(e)=>{
		return false;
};

window.onmousedown=(e)=>{
	if(e.button==1){
		return false;
	}
};

function elRemover(el){
	if(typeof el!=='undefined' && !!el){
	if(typeof el.parentNode!=='undefined' && !!el.parentNode){
		el.parentNode.removeChild(el);
	}
	}
}


function pDistance(x, y, x1, y1, x2, y2) {
//source: https://stackoverflow.com/a/6853926 (Joshua)
  var A = x - x1;
  var B = y - y1;
  var C = x2 - x1;
  var D = y2 - y1;

  var dot = A * C + B * D;
  var len_sq = C * C + D * D;
  var param = -1;
  if (len_sq != 0) //in case of 0 length line
      param = dot / len_sq;

  var xx, yy;

  if (param < 0){
    xx = x1;
    yy = y1;
  }else if (param > 1){
    xx = x2;
    yy = y2;
  }else{
    xx = x1 + param * C;
    yy = y1 + param * D;
  }

  var dx = x - xx;
  var dy = y - yy;
  return Math.sqrt(dx * dx + dy * dy);
}

function countMarkers(){
	scoreboard.hts.innerText=document.querySelectorAll('div.mrk.home').length;
	scoreboard.ats.innerText=document.querySelectorAll('div.mrk.away').length;
}

window.onpointerup=(event)=>{
	event.preventDefault();
	event.stopPropagation();
	if(event.target!==drg && !event.composedPath().includes(scoreboard.board) && (event.button===0 || event.button===2 ) ){
		let n=(event.button===2)?'A':'H';
		let d=document.createElement('div'); 
		document.body.append(d); 
		d.className='mrk '+((event.button===2)?'away':'home');
		d.innerText=n;
		d.title='Middle-click to delete';
		d.style.cssText='user-select: none;width: min-content;height: min-content;position: absolute; background:'+ ((event.button===2)?'mediumblue':'purple')+';border-radius: 50%;transform: scaleY(0.6007) scale(0.865);font-family: MONOSPACE;';
		d.style.left=event.pageX-0.5*d.clientWidth;
		d.style.top=event.pageY-0.5*d.clientHeight;
		countMarkers();
	}
	drg=null;
}

window.onpointermove=(event)=>{
	if(drg!==null){
		drg.style.left=event.pageX-0.5*drg.clientWidth;
		drg.style.top=event.pageY-0.5*drg.clientHeight;
	}
	dists(event);
}

window.onpointerdown=(event)=>{
	if(event.target?.matches('div.mrk')){
		if(event.button===1){
			elRemover(event.target);
			countMarkers();
		}else{
				drg=event.target;
		}
	}
}

function dists(event){

var gl1R=absBoundingClientRect(gl1);
var gl2R=absBoundingClientRect(gl2);
let pitchLen=gl2R.right-gl1R.left; //105m
let scl=105/pitchLen;

let a=pDistance(event.pageX,event.pageY, gl1R.left, gl1R.top, gl1R.left, gl1R.bottom)*scl;
a=(event.pageX<gl1R.left)?-a:a;

let b=pDistance(event.pageX,event.pageY, gl2R.right, gl2R.top, gl2R.right, gl2R.bottom)*scl;
b=(event.pageX>gl2R.right)?-b:b;

dv.innerText='Distance to left goalline: '+a.toLocaleString('en-GB',{minimumFractionDigits: 0,	maximumFractionDigits: 3})+'m ('+(a*1.0936133).toLocaleString('en-GB',{minimumFractionDigits: 0, maximumFractionDigits: 3})+' yds)\nDistance to right goalline: '+b.toLocaleString('en-GB',{minimumFractionDigits: 0,	maximumFractionDigits: 3})+'m ('+(b*1.0936133).toLocaleString('en-GB',{minimumFractionDigits: 0, maximumFractionDigits: 3})+' yds)';
if(!firstDist){
	firstDist=true;
	rsz();
}
}

</script>

</body>

</html>
